---
import { getCollection } from "astro:content";
import PageLayout from "@/layouts/Base.astro";
import { Icon } from "astro-icon/components";
import ProjectCard from "@/components/project/ProjectCard.astro";

const allProjects = await getCollection("project");
const projectsByDate = allProjects.sort(
	(a, b) => (b.data.publishDate?.getTime() ?? 0) - (a.data.publishDate?.getTime() ?? 0),
);
---

<PageLayout meta={{ title: "Projects" }}>
	<section>
		<h2 class="title mb-12 flex items-center gap-3">
			Projects
			<a class="text-accent" href="/projects/rss.xml" target="_blank">
				<span class="sr-only">RSS feed</span>
				<Icon aria-hidden="true" class="h-6 w-6" focusable="false" name="mdi:rss" />
			</a>
		</h2>
		{
			projectsByDate.length === 0 ? (
				<p>No projects yet.</p>
			) : (
				<ul class="space-y-8 text-start" role="list">
					{projectsByDate.map((p) => (
						<li>
							<ProjectCard project={p} />
						</li>
					))}
				</ul>
			)
		}
	</section>
</PageLayout>
